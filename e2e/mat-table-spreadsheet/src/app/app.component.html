<mat-sidenav-container>
  <mat-sidenav #sidenav></mat-sidenav>
  <mat-sidenav-content>
    <mat-toolbar class="mat-elevation-z5" color="primary">
      <button mat-icon-button (click)="sidenav.toggle()">
        <mat-icon>menu</mat-icon>
      </button>
      <span>My App</span>
      <span class="spacer"></span>
      <button mat-icon-button>
        <mat-icon>favorite</mat-icon>
      </button>
      <button mat-icon-button>
        <mat-icon>share</mat-icon>
      </button>
    </mat-toolbar>

    <mat-table
      matSpreadsheet
      mat-table
      [dataSource]="dataSource"
      [trackBy]="trackBy"
    >
      <ng-container matColumnDef="position">
        <mat-header-cell *matHeaderCellDef> Position </mat-header-cell>
        <mat-cell *matCellDef="let element" #matCell="matCell">
          <mat-spreadsheet-select
            [connectCell]="matCell"
            [list]="list"
            [listOptionRenderKey]="'position'"
            [placeholder]="element.position"
            (selectionChange)="onChange($event.value, element, 'position')"
          >
            {{ element.position }}
          </mat-spreadsheet-select>
        </mat-cell>
      </ng-container>
      <ng-container matColumnDef="name">
        <mat-header-cell *matHeaderCellDef> Name </mat-header-cell>
        <mat-cell *matCellDef="let element" #matCell="matCell">
          <mat-spreadsheet-combobox
            [connectCell]="matCell"
            [list]="list"
            [listOptionRenderKey]="'name'"
            [listOptionValue]="'name'"
            [placeholder]="element.name"
            (selectionChange)="console($event, element, 'name')"
          >
            {{ element.name }}
          </mat-spreadsheet-combobox>
        </mat-cell>
      </ng-container>
      <ng-container matColumnDef="check">
        <mat-header-cell *matHeaderCellDef> Check </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="inactive" #inactive>{{ element.check }}</div>
          <ng-template #active>
            <mat-select
              class="active"
              (selectionChange)="onChange($event.value, element, 'check')"
            >
              <mat-option *ngFor="let item of list" [value]="item">
                {{ item.check }}
              </mat-option>
            </mat-select>
          </ng-template>
        </mat-cell>
      </ng-container>
      <ng-container matColumnDef="check1">
        <mat-header-cell *matHeaderCellDef> Check1 </mat-header-cell>
        <mat-cell *matCellDef="let element"> 1 </mat-cell>
      </ng-container>
      <ng-container matColumnDef="check2">
        <mat-header-cell *matHeaderCellDef> Check2 </mat-header-cell>
        <mat-cell *matCellDef="let element"> 2 </mat-cell>
      </ng-container>
      <ng-container matColumnDef="check3">
        <mat-header-cell *matHeaderCellDef> Check3 </mat-header-cell>
        <mat-cell *matCellDef="let element">
          <div class="inactive" #inactive>3</div>
          <ng-template #active>
            <mat-select class="active">
              <mat-option *ngFor="let item of list" [value]="item">
                {{ item.name }}
              </mat-option>
            </mat-select>
          </ng-template>
        </mat-cell>
      </ng-container>
      <mat-header-row
        mat-header-row
        *matHeaderRowDef="columns"
      ></mat-header-row>
      <mat-row *matRowDef="let row; columns: columns"></mat-row>
    </mat-table>
  </mat-sidenav-content>
</mat-sidenav-container>
